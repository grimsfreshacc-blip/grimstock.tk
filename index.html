<!DOCTYPE html>
<html>
<head>
  <title>Store</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Store</h1>
<button onclick="logout()">Logout</button>

<div id="products"></div>

<script>
if (localStorage.getItem("role") !== "buyer") {
  alert("Login required");
  location.href = "buyer-login.html";
}

const products = JSON.parse(localStorage.getItem("products") || "[]");
const el = document.getElementById("products");

products.forEach(p => {
  el.innerHTML += `
    <div class="card">
      <h3>${p.title}</h3>
      <p>${p.desc}</p>
      <button onclick="buy('${p.id}')">Purchase</button>
    </div>
  `;
});

function buy(id) {
  let orders = JSON.parse(localStorage.getItem("orders") || "[]");
  orders.push({
    id: "ORD-" + Math.random().toString(36).slice(2,8),
    product: id,
    buyer: localStorage.getItem("loggedUser"),
    status: "Pending"
  });
  localStorage.setItem("orders", JSON.stringify(orders));
  alert("Order created. Pay via CashApp & open support chat.");
}

function logout() {
  localStorage.clear();
  location.href = "buyer-login.html";
}
</script>
</body>
</html>
